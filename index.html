<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Spammer</title>
    <link rel="icon" href="logo.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom styles */
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }
        .message-box { min-height: 150px; }
        .success-toast {
            animation: slideIn 0.5s forwards, fadeOut 0.5s 2.5s forwards;
        }
        @keyframes slideIn {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        .text-gradient {
            background: linear-gradient(90deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
        }
        .btn-gradient:hover { opacity: 0.9; }
        .scrollbar-thin {
            scrollbar-width: thin;
            scrollbar-color: #764ba2 #f3f4f6;
        }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #764ba2;
            border-radius: 6px;
        }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; }
        
        /* Dark mode toggle */
        .dark .dark\:bg-dark { background-color: #1a1a2e; }
        .dark .dark\:bg-card { background-color: #16213e; }
        .dark .dark\:text-white { color: #fff; }
        .dark .dark\:border-dark { border-color: #2a2a3a; }
        .dark .dark\:input-bg { background-color: #2a2a3a; color: #fff; }
        .dark .dark\:input-bg:focus { background-color: #333344; }
        .dark .dark\:section-title { color: #a78bfa; }
        
        /* Transition effects */
        .transition-all { transition: all 0.3s ease; }
        
        /* New custom styles */
        .progress-bar {
            height: 6px;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        .token-badge {
            font-family: monospace;
            font-size: 0.85rem;
        }
        .tooltip {
            position: relative;
        }
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .rotate {
            animation: rotate 2s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans min-h-screen transition-all dark:bg-dark">
    <!-- Navigation -->
    <nav class="gradient-bg p-4 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <img src="logo1.png" alt="Logo" class="h-10 w-10 rounded-full shadow" />
                <h1 class="text-2xl font-bold text-white">Discord Spammer</h1>
            </div>
            <div class="flex items-center space-x-4">
                <a href="https://discord.com" target="_blank" class="text-white hover:underline flex items-center space-x-1">
                    <span>Discord</span>
                    <i class="fas fa-external-link-alt text-xs"></i>
                </a>
                
                <!-- Dark Mode Toggle -->
                <button id="darkModeToggle" class="text-white p-2 rounded-full hover:bg-white hover:bg-opacity-20 transition">
                    <i id="darkModeIcon" class="fas fa-moon"></i>
                </button>
                
                <!-- Language Switcher -->
                <select id="langSwitcher" class="bg-white bg-opacity-20 text-white px-2 py-1 rounded focus:outline-none border border-white border-opacity-30 dark:bg-gray-800 dark:text-purple-300 dark:border-purple-500">
                    <option value="en">EN</option>
                    <option value="vi">VI</option>
                </select>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Progress Bar (Hidden by default) -->
            <div id="globalProgress" class="hidden mb-6">
                <div class="flex justify-between items-center mb-1">
                    <span id="progressText" class="text-sm font-medium text-purple-600 dark:text-purple-400">Progress: 0%</span>
                    <span id="progressCount" class="text-sm text-gray-600 dark:text-gray-400">0/0</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                    <div id="progressBar" class="progress-bar bg-purple-600 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <!-- Info Card -->
            <div id="infoCard" class="bg-white rounded-xl p-6 mb-8 shadow-xl border border-gray-200 dark:bg-card dark:border-dark">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold flex items-center section-title dark:section-title">
                        <i class="fas fa-info-circle mr-2"></i>
                        <span data-en="How to use" data-vi="Hướng dẫn sử dụng">How to use</span>
                    </h2>
                    <button id="toggleInfoCard" class="text-gray-500 hover:text-purple-600 dark:text-gray-400 dark:hover:text-purple-300">
                        <i class="fas fa-chevron-up"></i>
                    </button>
                </div>
                <div id="infoCardContent">
                    <ol class="list-decimal list-inside space-y-2 text-gray-700 dark:text-gray-300">
                        <li data-en="1. Create a webhook in your Discord server settings (Server Settings &gt; Integrations &gt; Webhooks)."
                            data-vi="1. Tạo webhook trong cài đặt máy chủ Discord (Cài đặt máy chủ &gt; Tích hợp &gt; Webhooks).">
                            1. Create a webhook in your Discord server settings (Server Settings &gt; Integrations &gt; Webhooks).
                        </li>
                        <li data-en="2. Paste the webhook URL below. You can add multiple webhooks, each with its own username and avatar."
                            data-vi="2. Dán URL webhook vào ô bên dưới. Có thể thêm nhiều webhook, mỗi webhook có tên và ảnh riêng.">
                            2. Paste the webhook URL below. You can add multiple webhooks, each with its own username and avatar.
                        </li>
                        <li data-en="3. Enter your message. Each line will be sent as a separate message to all webhooks."
                            data-vi="3. Nhập nội dung tin nhắn. Mỗi dòng sẽ được gửi như một tin nhắn riêng tới tất cả webhook.">
                            3. Enter your message. Each line will be sent as a separate message to all webhooks.
                        </li>
                        <li data-en="4. Adjust message count, delay, and variance as needed. You can also use advanced options for embeds."
                            data-vi="4. Tuỳ chỉnh số lượng, độ trễ, ngẫu nhiên và các tuỳ chọn nâng cao như embeds.">
                            4. Adjust message count, delay, and variance as needed. You can also use advanced options for embeds.
                        </li>
                        <li data-en="5. Click &quot;Start Spam&quot; to begin. Progress will be shown. Click &quot;Stop Spam&quot; to stop."
                            data-vi="5. Nhấn &quot;Bắt đầu spam&quot; để gửi. Tiến trình sẽ hiển thị. Nhấn &quot;Dừng spam&quot; để dừng.">
                            5. Click "Start Spam" to begin. Progress will be shown. Click "Stop Spam" to stop.
                        </li>
                        <li data-en="6. For Member Spam, add tokens and channel ID, then enter messages and start spam."
                            data-vi="6. Với Spam tài khoản, thêm token và ID kênh, nhập tin nhắn rồi bắt đầu spam.">
                            6. For Member Spam, add tokens and channel ID, then enter messages and start spam.
                        </li>
                        <li data-en="7. Voice AFK Frame lets you manage tokens to simulate joining voice channels (for boosting/AFK)."
                            data-vi="7. Voice AFK Frame giúp quản lý token để giả lập vào kênh voice (dùng boost/AFK).">
                            7. Voice AFK Frame lets you manage tokens to simulate joining voice channels (for boosting/AFK).
                        </li>
                    </ol>
                </div>
            </div>

            <!-- Webhook Form -->
            <div class="bg-white rounded-xl p-6 shadow-xl border border-gray-200 dark:bg-card dark:border-dark">
                <h2 class="text-2xl font-bold mb-6 text-center section-title dark:section-title">
                    <i class="fas fa-paper-plane mr-2"></i>
                    <span data-en="Webhook Spammer" data-vi="Spam bằng Webhook">Webhook Spammer</span>
                </h2>
                
                <form id="webhookForm" class="space-y-6">
                    <!-- Webhook URL -->
                    <div>
                        <label class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                            <i class="fas fa-link mr-2"></i>
                            <span data-en="Webhook URLs" data-vi="Danh sách Webhook URL">Webhook URLs</span>
                        </label>
                        <div class="flex flex-col md:flex-row gap-2 mb-2">
                            <input type="url" id="webhookUrlInput"
                                class="flex-1 px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="https://discord.com/api/webhooks/...">
                            <input type="text" id="webhookNameInput"
                                class="w-full md:w-32 px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="Username">
                            <input type="url" id="webhookAvatarInput"
                                class="w-full md:w-40 px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="Avatar URL">
                            <button type="button" id="addWebhookBtn"
                                class="btn-gradient px-4 py-2 rounded-md font-bold pulse-animation hover:scale-105 transition-transform">
                                <i class="fas fa-plus"></i> <span data-en="Add" data-vi="Thêm">Add</span>
                            </button>
                            <button type="button" id="toggleWebhookListBtn"
                                class="bg-gray-100 text-purple-700 px-3 py-2 rounded-md font-bold border border-gray-300 dark:input-bg dark:border-dark hover:bg-gray-200 dark:hover:bg-gray-600 transition"
                                title="Show/Hide Webhook List">
                                <i id="webhookListChevron" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                        </div>
                        <ul id="webhookList" class="mb-2 space-y-1"></ul>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Username -->
                        <div>
                            <label for="username" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-user mr-2"></i>
                                <span data-en="Username (optional)" data-vi="Tên người gửi (tuỳ chọn)">Username (optional)</span>
                            </label>
                            <input type="text" id="username"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="Custom username">
                        </div>

                        <!-- Avatar URL -->
                        <div>
                            <label for="avatarUrl" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-image mr-2"></i>
                                <span data-en="Avatar URL (optional)" data-vi="Ảnh đại diện (tuỳ chọn)">Avatar URL (optional)</span>
                            </label>
                            <input type="url" id="avatarUrl"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="https://example.com/avatar.png">
                        </div>
                    </div>

                    <!-- Message Content -->
                    <div>
                        <label for="message" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                            <i class="fas fa-comment-alt mr-2"></i>
                            <span data-en="Message Content" data-vi="Nội dung tin nhắn">Message Content</span>
                        </label>
                        <textarea id="message" required rows="5"
                            class="message-box w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                            placeholder="Type your message here..."></textarea>
                    </div>

                    <!-- TTS Checkbox -->
                    <div class="flex items-center">
                        <input type="checkbox" id="tts"
                            class="w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500 dark:bg-gray-700 dark:border-gray-600">
                        <label for="tts" class="ml-2 text-sm font-medium text-purple-600 dark:text-purple-400">
                            <span data-en="Text-to-Speech (TTS)" data-vi="Đọc to (TTS)">Text-to-Speech (TTS)</span>
                        </label>
                    </div>

                    <!-- Spam settings -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                        <div>
                            <label for="webhookSpamCount" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-redo mr-2"></i>
                                <span data-en="Message Count" data-vi="Số lượng tin nhắn">Message Count</span>
                            </label>
                            <input type="number" id="webhookSpamCount" min="1" max="500" value="5"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark">
                        </div>
                        <div>
                            <label for="webhookSpamDelay" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-clock mr-2"></i>
                                <span data-en="Delay (ms)" data-vi="Độ trễ (ms)">Delay (ms)</span>
                            </label>
                            <input type="number" id="webhookSpamDelay" min="100" max="10000" value="1000"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark">
                        </div>
                        <div>
                            <label for="webhookSpamVariance" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-random mr-2"></i>
                                <span data-en="Variance (±ms)" data-vi="Ngẫu nhiên (±ms)">Variance (±ms)</span>
                            </label>
                            <input type="number" id="webhookSpamVariance" min="0" max="5000" value="500"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark">
                        </div>
                    </div>
                                    
                    <!-- Action buttons -->
                    <div class="pt-2 flex flex-col sm:flex-row gap-2">
                        <button type="button" id="startWebhookSpamBtn"
                            class="btn-gradient font-bold py-2 px-4 rounded-md w-full transition duration-200 flex items-center justify-center pulse-animation hover:scale-[1.02]">
                            <i class="fas fa-paper-plane mr-2"></i>
                            <span data-en="Start Spam" data-vi="Bắt đầu spam">Start Spam</span>
                        </button>
                        <button type="button" id="stopWebhookSpamBtn" disabled
                            class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md w-full transition duration-200 flex items-center justify-center hover:scale-[1.02]">
                            <i class="fas fa-stop mr-2"></i>
                            <span data-en="Stop Spam" data-vi="Dừng spam">Stop Spam</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Chat Spam Options -->
            <div class="mt-8 bg-white rounded-xl p-6 shadow-xl border border-gray-200 dark:bg-card dark:border-dark">
                <h2 class="text-2xl font-bold mb-6 text-center section-title dark:section-title">
                    <i class="fas fa-comment-dots mr-2"></i>
                    <span data-en="Member Chat Spam" data-vi="Spam chat bằng tài khoản">Member Chat Spam</span>
                </h2>
                <div class="space-y-6">
                    <div>
                        <label for="spamMessage" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                            <i class="fas fa-comment-alt mr-2"></i>
                            <span data-en="Message to Spam" data-vi="Tin nhắn spam">Message to Spam</span>
                        </label>
                        <textarea id="spamMessage" rows="3"
                            class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                            placeholder="Message to send multiple times"></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="channelId" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-hashtag mr-2"></i>
                                <span data-en="Channel ID" data-vi="ID kênh">Channel ID</span>
                            </label>
                            <input type="text" id="channelId"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="Channel ID (required)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-key mr-2"></i>
                                <span data-en="Member Tokens" data-vi="Token tài khoản">Member Tokens</span>
                            </label>
                            <div class="flex flex-col md:flex-row gap-2 mb-2">
                                <input type="text" id="memberTokenInput"
                                    class="flex-1 px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                    placeholder="User token (required)">
                                <button type="button" id="addMemberTokenBtn"
                                    class="btn-gradient px-4 py-2 rounded-md font-bold pulse-animation hover:scale-105 transition-transform">
                                    <i class="fas fa-plus"></i> <span data-en="Add" data-vi="Thêm">Add</span>
                                </button>
                                <button type="button" id="toggleMemberTokenListBtn"
                                    class="bg-gray-100 text-purple-700 px-3 py-2 rounded-md font-bold border border-gray-300 dark:input-bg dark:border-dark hover:bg-gray-200 dark:hover:bg-gray-600 transition"
                                    title="Show/Hide Token List">
                                    <i id="memberTokenListChevron" class="fas fa-chevron-down transition-transform duration-200"></i>
                                </button>
                            </div>
                            <ul id="memberTokenList" class="mb-2 space-y-1"></ul>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label for="spamCount" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-redo mr-2"></i>
                                <span data-en="Message Count" data-vi="Số lượng tin nhắn">Message Count</span>
                            </label>
                            <input type="number" id="spamCount" min="1" max="500" value="5"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark">
                        </div>
                        <div>
                            <label for="spamDelay" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-clock mr-2"></i>
                                <span data-en="Delay (ms)" data-vi="Độ trễ (ms)">Delay (ms)</span>
                            </label>
                            <input type="number" id="spamDelay" min="100" max="10000" value="1000"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark">
                        </div>
                        <div>
                            <label for="spamVariance" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                                <i class="fas fa-random mr-2"></i>
                                <span data-en="Variance (±ms)" data-vi="Ngẫu nhiên (±ms)">Variance (±ms)</span>
                            </label>
                            <input type="number" id="spamVariance" min="0" max="5000" value="500"
                                class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark">
                        </div>
                    </div>

                    <div class="pt-4">
                        <button id="startSpamBtn"
                            class="btn-gradient font-bold py-3 px-6 rounded-md w-full transition duration-200 flex items-center justify-center pulse-animation hover:scale-[1.02]">
                            <i class="fas fa-play mr-2"></i>
                            <span data-en="Start Spam" data-vi="Bắt đầu spam">Start Spam</span>
                        </button>
                        <button id="stopSpamBtn" disabled
                            class="mt-2 bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-md w-full transition duration-200 flex items-center justify-center hover:scale-[1.02]">
                            <i class="fas fa-stop mr-2"></i>
                            <span data-en="Stop Spam" data-vi="Dừng spam">Stop Spam</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Voice AFK Frame -->
            <div class="mt-8 bg-white rounded-xl p-6 shadow-xl border border-gray-200 dark:bg-card dark:border-dark">
                <h2 class="text-2xl font-bold mb-6 text-center section-title dark:section-title">
                    <i class="fas fa-headphones-alt mr-2"></i>
                    <span data-en="Voice AFK Frame" data-vi="Voice AFK Frame">Voice AFK Frame</span>
                </h2>
                <div class="space-y-6">
                    <div>
                        <label for="afkTokenInput" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                            <i class="fas fa-key mr-2"></i>
                            <span data-en="Tokens" data-vi="Token">Tokens</span>
                        </label>
                        <div class="flex flex-col md:flex-row gap-2 mb-2">
                            <input type="text" id="afkTokenInput"
                                class="flex-1 px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                                placeholder="Token...">
                            <button type="button" id="addAfkTokenBtn"
                                class="btn-gradient px-4 py-2 rounded-md font-bold pulse-animation hover:scale-105 transition-transform">
                                <i class="fas fa-plus"></i> <span data-en="Add" data-vi="Thêm">Add</span>
                            </button>
                            <button type="button" id="toggleAfkTokenListBtn"
                                class="bg-gray-100 text-purple-700 px-3 py-2 rounded-md font-bold border border-gray-300 dark:input-bg dark:border-dark hover:bg-gray-200 dark:hover:bg-gray-600 transition"
                                title="Show/Hide Token List">
                                <i id="afkTokenListChevron" class="fas fa-chevron-down transition-transform duration-200"></i>
                            </button>
                        </div>
                        <ul id="afkTokenList" class="mb-2 space-y-1"></ul>
                    </div>
                    <div>
                        <label for="afkChannelIdInput" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                            <i class="fas fa-hashtag mr-2"></i>
                            <span data-en="Voice Channel ID" data-vi="ID kênh voice">Voice Channel ID</span>
                        </label>
                        <input type="text" id="afkChannelIdInput"
                            class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                            placeholder="123456789012345678">
                    </div>
                    <div class="flex items-center mb-2">
                        <input type="checkbox" id="afkAutoReconnect" class="mr-2 h-5 w-5 text-purple-600 dark:text-purple-400">
                        <label for="afkAutoReconnect" class="text-gray-700 dark:text-gray-300">
                            <span data-en="Auto-reconnect if disconnected" data-vi="Tự động kết nối lại khi bị out">Auto-reconnect if disconnected</span>
                        </label>
                    </div>
                    <div class="flex items-center mb-6">
                        <input type="checkbox" id="afkMuteMic" class="mr-2 h-5 w-5 text-purple-600 dark:text-purple-400" checked>
                        <label for="afkMuteMic" class="text-gray-700 dark:text-gray-300">
                            <span data-en="Mute microphone" data-vi="Tắt mic">Mute microphone</span>
                        </label>
                    </div>
                    <div class="flex flex-wrap gap-3">
                        <button id="afkConnectAllBtn" class="btn-gradient px-6 py-2 rounded-lg font-medium hover:opacity-90 transition flex items-center pulse-animation hover:scale-[1.02]">
                            <i class="fas fa-plug mr-2"></i> <span data-en="Connect All" data-vi="Kết nối tất cả">Connect All</span>
                        </button>
                        <button id="afkDisconnectAllBtn" class="bg-red-600 px-6 py-2 rounded-lg font-medium hover:bg-red-700 transition flex items-center hover:scale-[1.02]">
                            <i class="fas fa-power-off mr-2"></i> <span data-en="Disconnect All" data-vi="Ngắt tất cả">Disconnect All</span>
                        </button>
                    </div>
                    <div class="bg-white bg-opacity-80 rounded-lg p-4 mt-6 border border-gray-200 dark:bg-gray-800 dark:border-dark">
                        <h3 class="text-lg font-medium mb-3 text-purple-600 dark:text-purple-400 flex items-center">
                            <i class="fas fa-info-circle mr-2"></i>
                            <span data-en="Connection Status" data-vi="Trạng thái kết nối">Connection Status</span>
                        </h3>
                        <div id="afkStatusDisplay" class="space-y-3 max-h-64 overflow-y-auto scrollbar-thin">
                            <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                <i class="fas fa-info-circle text-3xl mb-3"></i>
                                <p data-en="No active connections. Add tokens and connect to a voice channel." data-vi="Chưa có kết nối nào. Thêm token và kết nối vào kênh voice.">
                                    No active connections. Add tokens and connect to a voice channel.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Options (Collapsible) -->
            <div class="mt-8 bg-white rounded-xl shadow-xl border border-gray-200 dark:bg-card dark:border-dark overflow-hidden">
                <button id="advancedToggle" class="w-full px-6 py-4 text-left font-bold section-title hover:bg-gray-100 dark:hover:bg-gray-700 transition duration-200 flex justify-between items-center dark:section-title">
                    <span><i class="fas fa-cog mr-2"></i> <span data-en="Advanced Options" data-vi="Tuỳ chọn nâng cao">Advanced Options</span></span>
                    <i id="advancedChevron" class="fas fa-chevron-down transition-transform duration-200"></i>
                </button>
                <div id="advancedContent" class="hidden px-6 pb-6 space-y-6">
                    <div>
                        <label for="embeds" class="block text-sm font-medium mb-2 text-purple-600 dark:text-purple-400">
                            <i class="fas fa-code mr-2"></i> <span data-en="Embeds (JSON)" data-vi="Embeds (JSON)">Embeds (JSON)</span>
                        </label>
                        <textarea id="embeds" rows="5"
                            class="w-full px-4 py-2 bg-gray-100 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple dark:input-bg dark:border-dark"
                            placeholder='[{"title":"Embed Title","description":"Embed Description","color":5814783}]'></textarea>
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1" data-en="Note: This should be a valid JSON array of embed objects" data-vi="Lưu  ý: Phải là một mảng JSON hợp lệ của các đối tượng embed">Note: This should be a valid JSON array of embed objects</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 hidden z-50">
        <div class="success-toast bg-gradient-to-r from-purple-500 to-indigo-500 text-white px-6 py-3 rounded-md shadow-lg flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="toastMessage">Message sent successfully!</span>
        </div>
    </div>

    <footer class="gradient-bg p-4 mt-12">
        <div class="container mx-auto text-center">
            <p class="text-sm text-white">Discord Webhook Sender &copy; 2023 | Not affiliated with Discord</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Dark mode toggle
            const darkModeToggle = document.getElementById('darkModeToggle');
            const darkModeIcon = document.getElementById('darkModeIcon');
            const html = document.documentElement;
            
            // Check for saved theme preference or use system preference
            const savedTheme = localStorage.getItem('theme') ||
                               (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            
            if (savedTheme === 'dark') {
                html.classList.add('dark');
                darkModeIcon.classList.replace('fa-moon', 'fa-sun');
            }
            
            darkModeToggle.addEventListener('click', () => {
                html.classList.toggle('dark');
                const isDark = html.classList.contains('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                darkModeIcon.classList.toggle('fa-moon', !isDark);
                darkModeIcon.classList.toggle('fa-sun', isDark);
            });

            // Toggle info card content
            const toggleInfoCard = document.getElementById('toggleInfoCard');
            const infoCardContent = document.getElementById('infoCardContent');
            toggleInfoCard.addEventListener('click', function() {
                infoCardContent.classList.toggle('hidden');
                const icon = toggleInfoCard.querySelector('i');
                icon.classList.toggle('fa-chevron-up');
                icon.classList.toggle('fa-chevron-down');
            });

            // Toggle advanced options
            const advancedToggle = document.getElementById('advancedToggle');
            const advancedContent = document.getElementById('advancedContent');
            const advancedChevron = document.getElementById('advancedChevron');
            
            advancedToggle.addEventListener('click', function() {
                advancedContent.classList.toggle('hidden');
                advancedChevron.classList.toggle('rotate-180');
            });

            // Language Switcher
            const langSwitcher = document.getElementById('langSwitcher');
            function setLang(lang) {
                document.querySelectorAll('[data-en]').forEach(el => {
                    el.innerHTML = el.getAttribute('data-' + lang);
                });
                
                // Update placeholders
                document.getElementById('webhookUrlInput').placeholder = lang === 'vi' 
                    ? 'https://discord.com/api/webhooks/...' 
                    : 'https://discord.com/api/webhooks/...';
                document.getElementById('username').placeholder = lang === 'vi' 
                    ? 'Tên người gửi tuỳ chọn' 
                    : 'Custom username';
                document.getElementById('avatarUrl').placeholder = lang === 'vi' 
                    ? 'https://example.com/avatar.png' 
                    : 'https://example.com/avatar.png';
                document.getElementById('message').placeholder = lang === 'vi' 
                    ? 'Nhập nội dung tin nhắn, mỗi dòng là một tin riêng...' 
                    : 'Type your message here, each line is a separate message...';
                document.getElementById('spamMessage').placeholder = lang === 'vi' 
                    ? 'Tin nhắn spam, mỗi dòng là một tin riêng' 
                    : 'Message to send multiple times';
                document.getElementById('channelId').placeholder = lang === 'vi' 
                    ? 'ID kênh (bắt buộc)' 
                    : 'Channel ID (required)';
                document.getElementById('memberTokenInput').placeholder = lang === 'vi' 
                    ? 'Token người dùng (bắt buộc)' 
                    : 'User token (required)';
                document.getElementById('embeds').placeholder = lang === 'vi' 
                    ? '[{"title":"Tiêu đề","description":"Mô tả","color":5814783}]' 
                    : '[{"title":"Embed Title","description":"Embed Description","color":5814783}]';
            }
            
            langSwitcher.addEventListener('change', function() {
                setLang(this.value);
                localStorage.setItem('lang', this.value);
            });
            
            // Auto load language
            const savedLang = localStorage.getItem('lang') || 'en';
            langSwitcher.value = savedLang;
            setLang(savedLang);

            // Toast notification
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            function showToast(message, type) {
                toastMessage.textContent = message;
                const toastContent = toast.querySelector('div');
                toastContent.className = 'success-toast px-6 py-3 rounded-md shadow-lg flex items-center';
                
                if (type === 'success') {
                    toastContent.classList.add('bg-green-600');
                } else if (type === 'error') {
                    toastContent.classList.add('bg-red-600');
                } else if (type === 'warning') {
                    toastContent.classList.add('bg-yellow-600');
                } else {
                    toastContent.classList.add('bg-blue-600');
                }
                
                toast.classList.remove('hidden');
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }

            // Multi-webhook management
            let webhooks = [];
            const webhookUrlInput = document.getElementById('webhookUrlInput');
            const webhookNameInput = document.getElementById('webhookNameInput');
            const webhookAvatarInput = document.getElementById('webhookAvatarInput');
            const addWebhookBtn = document.getElementById('addWebhookBtn');
            const webhookList = document.getElementById('webhookList');
            const toggleWebhookListBtn = document.getElementById('toggleWebhookListBtn');
            const webhookListChevron = document.getElementById('webhookListChevron');

            function renderWebhookList() {
                webhookList.innerHTML = '';
                webhooks.forEach((wh, idx) => {
                    const li = document.createElement('li');
                    li.className = "flex items-center justify-between bg-gray-100 dark:bg-gray-700 rounded px-3 py-2 mb-1 fade-in";
                    li.innerHTML = `
                        <div class="flex items-center gap-2 overflow-hidden">
                            <span class="truncate max-w-xs" title="${wh.url}">${wh.url}</span>
                            ${wh.name ? `<span class="text-xs text-purple-600 dark:text-purple-400 ml-2" title="Username">${wh.name}</span>` : ''}
                            ${wh.avatar ? `<img src="${wh.avatar}" alt="avatar" class="w-5 h-5 rounded-full ml-1">` : ''}
                        </div>
                        <div class="flex items-center gap-1">
                            <button type="button" class="text-yellow-500 hover:text-yellow-600 dark:text-yellow-400 dark:hover:text-yellow-300 ml-2 edit-webhook-btn" data-idx="${idx}" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button type="button" class="text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300 ml-2" data-idx="${idx}" title="Remove">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    webhookList.appendChild(li);
                });
            }

            addWebhookBtn.addEventListener('click', function() {
                const url = webhookUrlInput.value.trim();
                const name = webhookNameInput.value.trim();
                const avatar = webhookAvatarInput.value.trim();
                
                if (!url) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập URL webhook' : 'Please enter a webhook URL', 'error');
                    return;
                }
                
                if (!/^https:\/\/discord\.com\/api\/webhooks\//.test(url)) {
                    showToast(langSwitcher.value === 'vi' ? 'URL webhook không hợp lệ' : 'Invalid webhook URL', 'error');
                    return;
                }
                
                if (webhooks.some(wh => wh.url === url)) {
                    showToast(langSwitcher.value === 'vi' ? 'Webhook đã được thêm' : 'Webhook already added', 'warning');
                    return;
                }
                
                webhooks.push({ url, name, avatar });
                webhookUrlInput.value = '';
                webhookNameInput.value = '';
                webhookAvatarInput.value = '';
                renderWebhookList();
                
                showToast(langSwitcher.value === 'vi' ? 'Đã thêm webhook' : 'Webhook added', 'success');
            });

            webhookList.addEventListener('click', function(e) {
                // Remove webhook
                if (e.target.closest('button') && e.target.closest('button').title === "Remove") {
                    const idx = e.target.closest('button').getAttribute('data-idx');
                    webhooks.splice(idx, 1);
                    renderWebhookList();
                    showToast(langSwitcher.value === 'vi' ? 'Đã xóa webhook' : 'Webhook removed', 'info');
                }
                
                // Edit webhook
                if (e.target.closest('button') && e.target.closest('button').title === "Edit") {
                    const idx = e.target.closest('button').getAttribute('data-idx');
                    const wh = webhooks[idx];
                    webhookUrlInput.value = wh.url;
                    webhookNameInput.value = wh.name || '';
                    webhookAvatarInput.value = wh.avatar || '';
                    webhooks.splice(idx, 1);
                    renderWebhookList();
                    showToast(langSwitcher.value === 'vi' ? 'Sẵn sàng chỉnh sửa' : 'Ready to edit', 'info');
                }
            });

            // Toggle webhook list visibility
            let webhookListVisible = true;
            toggleWebhookListBtn.addEventListener('click', function() {
                webhookListVisible = !webhookListVisible;
                webhookList.style.display = webhookListVisible ? '' : 'none';
                webhookListChevron.classList.toggle('fa-chevron-down', webhookListVisible);
                webhookListChevron.classList.toggle('fa-chevron-up', !webhookListVisible);
            });
            webhookList.style.display = '';
            webhookListChevron.classList.add('fa-chevron-down');
            webhookListChevron.classList.remove('fa-chevron-up');

            // Webhook Spam Functionality
            const startWebhookSpamBtn = document.getElementById('startWebhookSpamBtn');
            const stopWebhookSpamBtn = document.getElementById('stopWebhookSpamBtn');
            const globalProgress = document.getElementById('globalProgress');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const progressCount = document.getElementById('progressCount');
            
            let webhookSpamTimeout = null;
            let webhookSpamCounter = 0;
            let webhookSpamTotal = 0;
            let webhookSpamStopped = false;
            let webhookSpamMessages = [];
            let webhookSpamMsgIndex = 0;

            function updateProgress(counter, total) {
                const percent = Math.round((counter / total) * 100);
                progressBar.style.width = `${percent}%`;
                progressText.textContent = `Progress: ${percent}%`;
                progressCount.textContent = `${counter}/${total}`;
            }

            startWebhookSpamBtn.addEventListener('click', async function() {
                if (webhooks.length === 0) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng thêm ít nhất một webhook' : 'Please add at least one webhook', 'error');
                    return;
                }
                
                webhookSpamMessages = document.getElementById('message').value
                    .split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0);

                const globalUsername = document.getElementById('username').value.trim();
                const globalAvatar = document.getElementById('avatarUrl').value.trim();
                const tts = document.getElementById('tts').checked;
                const embedsInput = document.getElementById('embeds').value;
                const baseDelay = parseInt(document.getElementById('webhookSpamDelay').value);
                const variance = parseInt(document.getElementById('webhookSpamVariance').value);
                const messageCount = parseInt(document.getElementById('webhookSpamCount').value);

                if (webhookSpamMessages.length === 0) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập ít nhất một dòng tin nhắn' : 'Please enter at least one message', 'error');
                    return;
                }

                let embeds = [];
                if (embedsInput) {
                    try {
                        embeds = JSON.parse(embedsInput);
                    } catch (error) {
                        showToast(langSwitcher.value === 'vi' ? 'JSON embeds không hợp lệ' : 'Invalid JSON in embeds field', 'error');
                        return;
                    }
                }

                startWebhookSpamBtn.disabled = true;
                stopWebhookSpamBtn.disabled = false;
                webhookSpamCounter = 0;
                webhookSpamTotal = messageCount * webhooks.length;
                webhookSpamStopped = false;
                
                // Show and update progress bar
                globalProgress.classList.remove('hidden');
                updateProgress(0, webhookSpamTotal);

                showToast((langSwitcher.value === 'vi' ? 'Bắt đầu spam ' : 'Starting webhook spam of ') + webhookSpamTotal + (langSwitcher.value === 'vi' ? ' tin nhắn...' : ' messages...'), 'info');

                let msgIdx = 0;
                let sentCount = 0;

                async function sendWebhookSpam() {
                    if (webhookSpamStopped || sentCount >= messageCount) {
                        startWebhookSpamBtn.disabled = false;
                        stopWebhookSpamBtn.disabled = true;
                        showToast((langSwitcher.value === 'vi' ? 'Đã hoàn thành gửi ' : 'Finished sending ') + webhookSpamCounter + (langSwitcher.value === 'vi' ? ' tin nhắn' : ' messages'), 'success');
                        return;
                    }

                    const content = webhookSpamMessages[msgIdx % webhookSpamMessages.length];

                    for (let i = 0; i < webhooks.length; i++) {
                        if (webhookSpamStopped) break;
                        
                        const wh = webhooks[i];
                        const payload = {
                            content: content,
                            username: wh.name || globalUsername || undefined,
                            avatar_url: wh.avatar || globalAvatar || undefined,
                            tts: tts,
                            embeds: embeds.length > 0 ? embeds : undefined
                        };

                        try {
                            const response = await fetch(wh.url, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(payload)
                            });
                            
                            if (response.ok) {
                                webhookSpamCounter++;
                                updateProgress(webhookSpamCounter, webhookSpamTotal);
                            }
                        } catch (error) {
                            console.error('Error sending webhook:', error);
                        }
                    }

                    msgIdx++;
                    sentCount++;
                    
                    if (!webhookSpamStopped && sentCount < messageCount) {
                        const delay = baseDelay + (Math.random() * variance * 2 - variance);
                        webhookSpamTimeout = setTimeout(sendWebhookSpam, Math.max(0, delay));
                    } else {
                        startWebhookSpamBtn.disabled = false;
                        stopWebhookSpamBtn.disabled = true;
                        showToast((langSwitcher.value === 'vi' ? 'Đã hoàn thành' : 'Completed'), 'success');
                    }
                }
                
                sendWebhookSpam();
            });

            stopWebhookSpamBtn.addEventListener('click', function() {
                webhookSpamStopped = true;
                if (webhookSpamTimeout) clearTimeout(webhookSpamTimeout);
                startWebhookSpamBtn.disabled = false;
                stopWebhookSpamBtn.disabled = true;
                showToast(langSwitcher.value === 'vi'
                    ? `Đã dừng sau ${webhookSpamCounter} / ${webhookSpamTotal} tin nhắn`
                    : `Stopped after ${webhookSpamCounter} of ${webhookSpamTotal} messages`, 'warning');
            });

            // Multi-member-token management
            let memberTokens = [];
            const memberTokenInput = document.getElementById('memberTokenInput');
            const addMemberTokenBtn = document.getElementById('addMemberTokenBtn');
            const memberTokenList = document.getElementById('memberTokenList');
            const toggleMemberTokenListBtn = document.getElementById('toggleMemberTokenListBtn');
            const memberTokenListChevron = document.getElementById('memberTokenListChevron');

            function renderMemberTokenList() {
                memberTokenList.innerHTML = '';
                memberTokens.forEach((tk, idx) => {
                    const li = document.createElement('li');
                    li.className = "flex items-center justify-between bg-gray-100 dark:bg-gray-700 rounded px-3 py-2 mb-1 fade-in";
                    li.innerHTML = `
                        <span class="truncate max-w-xs token-badge" title="${tk}">${tk.slice(0, 10)}...${tk.slice(-6)}</span>
                        <button type="button" class="text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300 ml-2" data-idx="${idx}" title="Remove">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    memberTokenList.appendChild(li);
                });
            }

            addMemberTokenBtn.addEventListener('click', function() {
                const tk = memberTokenInput.value.trim();
                if (!tk) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập token' : 'Please enter a token', 'error');
                    return;
                }
                
                if (memberTokens.includes(tk)) {
                    showToast(langSwitcher.value === 'vi' ? 'Token đã được thêm' : 'Token already added', 'warning');
                    return;
                }
                
                memberTokens.push(tk);
                memberTokenInput.value = '';
                renderMemberTokenList();
                showToast(langSwitcher.value === 'vi' ? 'Đã thêm token' : 'Token added', 'success');
            });

            memberTokenList.addEventListener('click', function(e) {
                if (e.target.closest('button') && e.target.closest('button').title === "Remove") {
                    const idx = e.target.closest('button').getAttribute('data-idx');
                    memberTokens.splice(idx, 1);
                    renderMemberTokenList();
                    showToast(langSwitcher.value === 'vi' ? 'Đã xóa token' : 'Token removed', 'info');
                }
            });

            // Toggle member token list visibility
            let memberTokenListVisible = true;
            toggleMemberTokenListBtn.addEventListener('click', function() {
                memberTokenListVisible = !memberTokenListVisible;
                memberTokenList.style.display = memberTokenListVisible ? '' : 'none';
                memberTokenListChevron.classList.toggle('fa-chevron-down', memberTokenListVisible);
                memberTokenListChevron.classList.toggle('fa-chevron-up', !memberTokenListVisible);
            });
            memberTokenList.style.display = '';
            memberTokenListChevron.classList.add('fa-chevron-down');
            memberTokenListChevron.classList.remove('fa-chevron-up');

            // Chat Spam Functionality
            const startSpamBtn = document.getElementById('startSpamBtn');
            const stopSpamBtn = document.getElementById('stopSpamBtn');
            let spamInterval;
            let spamCounter = 0;
            let totalSpamCount = 0;
            let channelId = '';
            let spamMessages = [];
            let spamMsgIndex = 0;

            startSpamBtn.addEventListener('click', async function() {
                if (memberTokens.length === 0) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng thêm ít nhất một token' : 'Please add at least one token', 'error');
                    return;
                }
                
                spamMessages = document.getElementById('spamMessage').value
                    .split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0);

                totalSpamCount = parseInt(document.getElementById('spamCount').value);
                const baseDelay = parseInt(document.getElementById('spamDelay').value);
                const variance = parseInt(document.getElementById('spamVariance').value);

                if (spamMessages.length === 0) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập ít nhất một dòng tin nhắn' : 'Please enter at least one message to spam', 'error');
                    return;
                }
                
                channelId = document.getElementById('channelId').value;
                if (!channelId) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập ID kênh' : 'Please enter a channel ID', 'error');
                    return;
                }

                startSpamBtn.disabled = true;
                stopSpamBtn.disabled = false;
                spamCounter = 0;
                spamMsgIndex = 0;
                
                // Show and update progress bar
                globalProgress.classList.remove('hidden');
                updateProgress(0, totalSpamCount);

                showToast((langSwitcher.value === 'vi' ? 'Bắt đầu spam ' : 'Starting spam of ') + totalSpamCount + (langSwitcher.value === 'vi' ? ' tin nhắn...' : ' messages...'), 'info');

                const sendSpamMessage = async () => {
                    if (spamCounter >= totalSpamCount) {
                        clearInterval(spamInterval);
                        startSpamBtn.disabled = false;
                        stopSpamBtn.disabled = true;
                        showToast((langSwitcher.value === 'vi' ? 'Đã gửi xong ' : 'Finished sending ') + totalSpamCount + (langSwitcher.value === 'vi' ? ' tin nhắn' : ' messages'), 'success');
                        return;
                    }
                    
                    try {
                        const content = spamMessages[spamMsgIndex % spamMessages.length];
                        const token = memberTokens[spamCounter % memberTokens.length];
                        
                        await fetch(`https://discord.com/api/v9/channels/${channelId}/messages`, {
                            method: 'POST',
                            headers: {
                                'Authorization': token,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                content: content,
                                tts: false
                            })
                        });
                        
                        spamCounter++;
                        spamMsgIndex++;
                        document.getElementById('spamCount').value = totalSpamCount - spamCounter;
                        updateProgress(spamCounter, totalSpamCount);
                    } catch (error) {
                        clearInterval(spamInterval);
                        startSpamBtn.disabled = false;
                        stopSpamBtn.disabled = true;
                        showToast(langSwitcher.value === 'vi' ? 'Lỗi gửi tin nhắn' : 'Error sending spam message', 'error');
                    }
                };
                
                await sendSpamMessage();
                spamInterval = setInterval(sendSpamMessage, baseDelay + (Math.random() * variance * 2 - variance));
            });

            stopSpamBtn.addEventListener('click', function() {
                clearInterval(spamInterval);
                startSpamBtn.disabled = false;
                stopSpamBtn.disabled = true;
                showToast(langSwitcher.value === 'vi'
                    ? `Đã dừng sau ${spamCounter} / ${totalSpamCount} tin nhắn`
                    : `Stopped after ${spamCounter} of ${totalSpamCount} messages`, 'warning');
            });

            // Voice AFK Frame logic
            let afkTokens = [];
            let afkTokenStatus = {};
            const afkTokenInput = document.getElementById('afkTokenInput');
            const addAfkTokenBtn = document.getElementById('addAfkTokenBtn');
            const afkTokenList = document.getElementById('afkTokenList');
            const toggleAfkTokenListBtn = document.getElementById('toggleAfkTokenListBtn');
            const afkTokenListChevron = document.getElementById('afkTokenListChevron');
            const afkChannelIdInput = document.getElementById('afkChannelIdInput');
            const afkAutoReconnect = document.getElementById('afkAutoReconnect');
            const afkMuteMic = document.getElementById('afkMuteMic');
            const afkConnectAllBtn = document.getElementById('afkConnectAllBtn');
            const afkDisconnectAllBtn = document.getElementById('afkDisconnectAllBtn');
            const afkStatusDisplay = document.getElementById('afkStatusDisplay');

            function renderAfkTokenList() {
                afkTokenList.innerHTML = '';
                afkTokens.forEach((tk, idx) => {
                    const li = document.createElement('li');
                    li.className = "flex items-center justify-between bg-gray-100 dark:bg-gray-700 rounded px-3 py-2 mb-1 fade-in";
                    li.innerHTML = `
                        <span class="truncate max-w-xs token-badge" title="${tk}">${tk.slice(0, 10)}...${tk.slice(-6)}</span>
                        <button type="button" class="text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300 ml-2" data-idx="${idx}" title="Remove">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    afkTokenList.appendChild(li);
                });
            }

            addAfkTokenBtn.addEventListener('click', function() {
                const tk = afkTokenInput.value.trim();
                if (!tk) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập token' : 'Please enter a token', 'error');
                    return;
                }
                
                if (afkTokens.includes(tk)) {
                    showToast(langSwitcher.value === 'vi' ? 'Token đã được thêm' : 'Token already added', 'warning');
                    return;
                }
                
                afkTokens.push(tk);
                afkTokenInput.value = '';
                renderAfkTokenList();
                showToast(langSwitcher.value === 'vi' ? 'Đã thêm token' : 'Token added', 'success');
            });

            afkTokenList.addEventListener('click', function(e) {
                if (e.target.closest('button')) {
                    const idx = e.target.closest('button').getAttribute('data-idx');
                    afkTokens.splice(idx, 1);
                    renderAfkTokenList();
                    showToast(langSwitcher.value === 'vi' ? 'Đã xóa token' : 'Token removed', 'info');
                }
            });

            // Toggle AFK token list visibility
            let afkTokenListVisible = true;
            toggleAfkTokenListBtn.addEventListener('click', function() {
                afkTokenListVisible = !afkTokenListVisible;
                afkTokenList.style.display = afkTokenListVisible ? '' : 'none';
                afkTokenListChevron.classList.toggle('fa-chevron-down', afkTokenListVisible);
                afkTokenListChevron.classList.toggle('fa-chevron-up', !afkTokenListVisible);
            });
            afkTokenList.style.display = '';
            afkTokenListChevron.classList.add('fa-chevron-down');
            afkTokenListChevron.classList.remove('fa-chevron-up');

            // Update AFK status display
            function updateAfkStatusDisplay() {
                afkStatusDisplay.innerHTML = '';
                const connectedTokens = afkTokens.filter(token => afkTokenStatus[token]?.connected);

                if (connectedTokens.length === 0) {
                    afkStatusDisplay.innerHTML = `
                        <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                            <i class="fas fa-info-circle text-3xl mb-3"></i>
                            <p data-en="No active connections. Add tokens and connect to a voice channel."
                                data-vi="Chưa có kết nối nào. Thêm token và kết nối vào kênh voice.">
                                No active connections. Add tokens and connect to a voice channel.
                            </p>
                        </div>
                    `;
                    return;
                }

                connectedTokens.forEach(token => {
                    const statusItem = document.createElement('div');
                    statusItem.className = 'flex items-center justify-between bg-gray-100 dark:bg-gray-700 p-3 rounded-lg mb-2 fade-in';

                    const tokenInfo = document.createElement('div');
                    tokenInfo.className = 'flex items-center';

                    const statusDot = document.createElement('div');
                    statusDot.className = 'h-3 w-3 rounded-full mr-3 bg-green-500';

                    const tokenText = document.createElement('span');
                    tokenText.className = 'font-mono text-sm';
                    tokenText.textContent = `${token.substring(0, 6)}...${token.substring(token.length - 4)}`;

                    const channelInfo = document.createElement('div');
                    channelInfo.className = 'text-sm text-gray-500 dark:text-gray-400';
                    channelInfo.textContent = `Channel: ${afkTokenStatus[token].channelId}`;

                    tokenInfo.appendChild(statusDot);
                    tokenInfo.appendChild(tokenText);

                    const timeInfo = document.createElement('div');
                    timeInfo.className = 'text-xs text-gray-500 dark:text-gray-400';
                    timeInfo.textContent = `Connected: ${new Date(afkTokenStatus[token].timestamp).toLocaleTimeString()}`;

                    statusItem.appendChild(tokenInfo);
                    statusItem.appendChild(channelInfo);
                    statusItem.appendChild(timeInfo);

                    afkStatusDisplay.appendChild(statusItem);
                });
            }

            // Connect/disconnect functions
            function afkConnectToken(token) {
                const channelId = afkChannelIdInput.value.trim();
                if (!channelId) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập ID kênh voice' : 'Please enter a voice channel ID', 'error');
                    return;
                }
                
                afkTokenStatus[token] = {
                    connected: true,
                    channelId: channelId,
                    timestamp: new Date().toISOString()
                };
                
                updateAfkStatusDisplay();
                showToast(langSwitcher.value === 'vi' 
                    ? `Đã kết nối token tới kênh ${channelId}` 
                    : `Token connected to channel ${channelId}`, 'success');
                
                // In a real implementation, you would call Discord API to join voice channel here
            }

            function afkDisconnectToken(token) {
                if (!afkTokenStatus[token]?.connected) return;
                
                afkTokenStatus[token].connected = false;
                afkTokenStatus[token].disconnectedAt = new Date().toISOString();
                
                updateAfkStatusDisplay();
                showToast(langSwitcher.value === 'vi' ? 'Đã ngắt kết nối token' : 'Token disconnected', 'info');
                
                // In a real implementation, you would call Discord API to leave voice channel here
            }

            function afkConnectAllTokens() {
                const channelId = afkChannelIdInput.value.trim();
                if (!channelId) {
                    showToast(langSwitcher.value === 'vi' ? 'Vui lòng nhập ID kênh voice' : 'Please enter a voice channel ID', 'error');
                    return;
                }
                
                if (afkTokens.length === 0) {
                    showToast(langSwitcher.value === 'vi' ? 'Không có token để kết nối' : 'No tokens to connect', 'warning');
                    return;
                }
                
                afkTokens.forEach(token => {
                    if (!afkTokenStatus[token]?.connected) {
                        afkConnectToken(token);
                    }
                });
            }

            function afkDisconnectAllTokens() {
                if (afkTokens.length === 0) return;
                
                afkTokens.forEach(token => {
                    if (afkTokenStatus[token]?.connected) {
                        afkDisconnectToken(token);
                    }
                });
            }

            afkConnectAllBtn.addEventListener('click', afkConnectAllTokens);
            afkDisconnectAllBtn.addEventListener('click', afkDisconnectAllTokens);
        });
    </script>
</body>
</html>